{{define "content"}}
<div class="container">
    <h1 class="page-title">{{.Title}}</h1>

    <section class="controls-section">
        <div class="search-container">
            <form action="/search" method="GET" autocomplete="off" class="search-form">
                <input type="text" id="search-input" name="q" class="search-input"
                       placeholder="Rechercher un artiste..."
                       value="{{if .Query}}{{.Query}}{{end}}">
                <div id="suggestions-box" class="suggestions-box"></div>
                <button type="submit" class="btn-search">Rechercher</button>
            </form>
        </div>

        <div class="filters-wrapper">
            <p class="filters-label">Filtrer les r√©sultats</p>
            <form action="{{if .Query}}/search{{else}}/artists{{end}}" method="GET" class="filter-form" id="filter-form">
                {{if .Query}}<input type="hidden" name="q" value="{{.Query}}">{{end}}
                <div class="filter-row">
                    <div class="filter-group">
                        <label for="minYear">Ann√©e min</label>
                        <input type="number" id="minYear" name="minYear" placeholder="ex. 1990" value="{{.MinYear}}" min="1900" max="2030">
                    </div>
                    <div class="filter-group">
                        <label for="maxYear">Ann√©e max</label>
                        <input type="number" id="maxYear" name="maxYear" placeholder="ex. 2020" value="{{.MaxYear}}" min="1900" max="2030">
                    </div>
                    <div class="filter-group">
                        <label for="memberCount">Membres</label>
                        <select id="memberCount" name="memberCount" multiple class="filter-select">
                            <option value="1" {{if .Member1}}selected{{end}}>1</option>
                            <option value="2" {{if .Member2}}selected{{end}}>2</option>
                            <option value="3" {{if .Member3}}selected{{end}}>3</option>
                            <option value="4" {{if .Member4}}selected{{end}}>4</option>
                            <option value="5" {{if .Member5}}selected{{end}}>5+</option>
                        </select>
                    </div>
                    {{if .Locations}}
                    <div class="filter-group">
                        <label>Lieux</label>
                        <select name="location" multiple class="filter-select">
                            {{range .Locations}}
                            <option value="{{.}}" {{if index $.LocationSelected .}}selected{{end}}>{{.}}</option>
                            {{end}}
                        </select>
                    </div>
                    {{end}}
                    <div class="filter-actions">
                        <button type="submit" class="btn-filter">Appliquer</button>
                        <a href="/artists" class="btn-back">Tout effacer</a>
                    </div>
                </div>
            </form>
        </div>
    </section>

    {{if .APIError}}
    <div class="controls-section api-error-msg">
        <p class="api-error-title">Impossible de charger les artistes</p>
        <p class="api-error-desc">V√©rifiez <strong>SPOTIFY_CLIENT_ID</strong> et <strong>SPOTIFY_CLIENT_SECRET</strong>.</p>
    </div>
    {{end}}

    <div class="artists-grid">
        {{if .Artists}}
            {{range .Artists}}
            <article class="artist-card">
                {{if .Image}}
                <img src="{{.Image}}" alt="{{.Name}}" loading="lazy">
                {{else}}
                <div class="artist-card-noimg">üéµ</div>
                {{end}}
                <h2 class="artist-name">{{.Name}}</h2>
                <div class="artist-card-meta">
                    {{if .CreationDate}}<span>Cr√©ation {{.CreationDate}}</span>{{end}}
                    {{if .Members}}<span>{{len .Members}} membre(s)</span>{{end}}
                    {{if .FirstAlbum}}<span>Album {{.FirstAlbum}}</span>{{end}}
                </div>
                <a href="/artist/{{.ID}}" class="btn-details">Voir la fiche</a>
            </article>
            {{end}}
        {{else}}
            <div class="artists-empty">
                <p>Aucun artiste trouv√©.</p>
                <p>Modifiez la recherche ou les filtres, ou <a href="/artists">affichez tous les artistes</a>.</p>
            </div>
        {{end}}
    </div>
</div>
{{end}}
